(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1795],{5162:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(7294),r=a(6010);const l="tabItem_Ymn6";function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,i),hidden:a},t)}},4866:(e,t,a)=>{"use strict";a.d(t,{Z:()=>w});var n=a(7462),r=a(7294),l=a(6010),i=a(2466),u=a(6775),o=a(1980),s=a(7392),p=a(12);function m(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function d(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=t??m(a);return function(e){const t=(0,s.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function c(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:a}=e;const n=(0,u.k6)(),l=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,o._X)(l),(0,r.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(n.location.search);t.set(l,e),n.replace({...n.location,search:t.toString()})}),[l,n])]}function k(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,l=d(e),[i,u]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!c({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:l}))),[o,s]=g({queryString:a,groupId:n}),[m,k]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,l]=(0,p.Nk)(a);return[n,(0,r.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:n}),h=(()=>{const e=o??m;return c({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{h&&u(h)}),[h]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!c({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);u(e),s(e),k(e)}),[s,k,l]),tabValues:l}}var h=a(2389);const N="tabList__CuJ",b="tabItem_LNqP";function v(e){let{className:t,block:a,selectedValue:u,selectValue:o,tabValues:s}=e;const p=[],{blockElementScrollPositionUntilNextRender:m}=(0,i.o5)(),d=e=>{const t=e.currentTarget,a=p.indexOf(t),n=s[a].value;n!==u&&(m(t),o(n))},c=e=>{var t;let a=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=p.indexOf(e.currentTarget)+1;a=p[t]??p[0];break}case"ArrowLeft":{const t=p.indexOf(e.currentTarget)-1;a=p[t]??p[p.length-1];break}}null==(t=a)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},t)},s.map((e=>{let{value:t,label:a,attributes:i}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:u===t?0:-1,"aria-selected":u===t,key:t,ref:e=>p.push(e),onKeyDown:c,onClick:d},i,{className:(0,l.Z)("tabs__item",b,null==i?void 0:i.className,{"tabs__item--active":u===t})}),a??t)})))}function f(e){let{lazy:t,children:a,selectedValue:n}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function y(e){const t=k(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",N)},r.createElement(v,(0,n.Z)({},e,t)),r.createElement(f,(0,n.Z)({},e,t)))}function w(e){const t=(0,h.Z)();return r.createElement(y,(0,n.Z)({key:String(t)},e))}},8282:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(7294),r=a(7623),l=a(2949);const i=e=>{let{chart:t}=e;const a=(0,n.useRef)(null),[i]=(0,n.useState)("mermaid-"+Math.random().toString(36).slice(4)),{colorMode:u}=(0,l.I)();return(0,n.useEffect)((()=>{r.Z.mermaidAPI.initialize({startOnLoad:!0,securityLevel:"loose",logLevel:5})})),(0,n.useEffect)((()=>{a.current&&""!==t&&r.Z.mermaidAPI.render(i,`%%{init: {'theme':'${"dark"===u?"dark":"neutral"}'}}%%`+t,(e=>{a.current.innerHTML=e}))}),[t,u]),n.createElement("div",{key:i,ref:a})}},1413:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(7294),r=a(5864);const l=e=>{let{url:t,language:a="js",showLineNumbers:l,title:i,className:u,metastring:o}=e;const[s,p]=(0,n.useState)("Loading...");return(0,n.useEffect)((()=>{fetch(t).then((e=>e.text())).then((e=>p(e))).catch((e=>p(e)))}),[]),n.createElement(r.Z,{children:s,showLineNumbers:l,title:i,className:u,metastring:o,language:a})}},7122:(e,t,a)=>{"use strict";a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>m,default:()=>N,frontMatter:()=>p,metadata:()=>d,toc:()=>k});var n=a(7462),r=(a(7294),a(3905)),l=a(4866),i=a(5162),u=a(7793),o=a(1413),s=a(8282);const p={},m="\ud83d\udce6 Arguments",d={unversionedId:"plugins/arguments",id:"plugins/arguments",title:"\ud83d\udce6 Arguments",description:"This plugin allows you to easily parse and validate command / inline query arguments with Joi",source:"@site/docs/plugins/arguments.mdx",sourceDirName:"plugins",slug:"/plugins/arguments",permalink:"/ru/docs/plugins/arguments",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/arguments.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udce6 Arguments plugin",permalink:"/ru/docs/live-examples/plugin-arguments"},next:{title:"\ud83c\udfde Media group",permalink:"/ru/docs/plugins/media-group"}},c={},g="https://raw.githubusercontent.com/OpengramJS/arguments/master/examples",k=[{value:"Installing a plugin",id:"installing-a-plugin",level:2},{value:"How to use",id:"how-to-use",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Mapping",id:"mapping",level:3},{value:"Error handling",id:"error-handling",level:3},{value:"Result object",id:"result-object",level:3},{value:"Usage example",id:"usage-example",level:2},{value:"Command",id:"command",level:3},{value:"Inline query",id:"inline-query",level:3},{value:"Additional Information",id:"additional-information",level:2}],h={toc:k};function N(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"-arguments"},"\ud83d\udce6 Arguments"),(0,r.kt)("p",null,"This plugin allows you to easily parse and validate command / inline query arguments with ",(0,r.kt)("a",{parentName:"p",href:"https://joi.dev/"},"Joi")),(0,r.kt)("p",null,"Plugin works with ",(0,r.kt)("strong",{parentName:"p"},"inline query"),", ",(0,r.kt)("strong",{parentName:"p"},"channel posts")," and ",(0,r.kt)("strong",{parentName:"p"},"messages")),(0,r.kt)("h2",{id:"installing-a-plugin"},"Installing a plugin"),(0,r.kt)(l.Z,{defaultValue:"npm",values:[{label:"NPM",value:"npm"},{label:"Yarn",value:"yarn"},{label:"pnpm",value:"pnpm"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @opengram/arguments\n"))),(0,r.kt)(i.Z,{value:"yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @opengram/arguments\n"))),(0,r.kt)(i.Z,{value:"pnpm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pnpm add @opengram/arguments\n")))),(0,r.kt)("h2",{id:"how-to-use"},"How to use"),(0,r.kt)("p",null,"You need to create new ",(0,r.kt)("a",{parentName:"p",href:"https://joi.dev/"},"Joi")," validation schema and pass it to ",(0,r.kt)("inlineCode",{parentName:"p"},"arguments")," plugin with\n",(0,r.kt)("inlineCode",{parentName:"p"},"errorHandler")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"mapping")," array."),(0,r.kt)("h3",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"Accepted fields:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"),(0,r.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"mapping")),(0,r.kt)("td",{parentName:"tr",align:null},"The array contains a name for every argument. Used for remapping arguments and validation scheme"),(0,r.kt)("td",{parentName:"tr",align:null},"No (Yes if validation used)"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"schema")),(0,r.kt)("td",{parentName:"tr",align:null},"Joi validation scheme"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"config")),(0,r.kt)("td",{parentName:"tr",align:null},"Joi config"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{ convert: true, allowUnknown: true, abortEarly: false } "))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"errorHandler")),(0,r.kt)("td",{parentName:"tr",align:null},"Error handler for validation error. If not defined, thowen error can handled with ",(0,r.kt)("inlineCode",{parentName:"td"},"bot.catch")),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"allowedUpdates")),(0,r.kt)("td",{parentName:"tr",align:null},"List of allowed to parse updates"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"['message', 'channel_post', 'inline_query']"))))),(0,r.kt)("h3",{id:"mapping"},"Mapping"),(0,r.kt)("p",null,"This array shows for plugin how to remap argument ",(0,r.kt)("strong",{parentName:"p"},"index")," to ",(0,r.kt)("strong",{parentName:"p"},"argument name")," and used for validation with ",(0,r.kt)("inlineCode",{parentName:"p"},"Joi"),"."),(0,r.kt)("p",null,"For example, if you declare an object like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"['firstarg', 'secondarg']\n")),(0,r.kt)("p",null,"It means ",(0,r.kt)("strong",{parentName:"p"},"first argument")," be mapped to ",(0,r.kt)("inlineCode",{parentName:"p"},"firstarg")," and ",(0,r.kt)("strong",{parentName:"p"},"second")," mapped to ",(0,r.kt)("inlineCode",{parentName:"p"},"secondarg")," in result\n",(0,r.kt)("inlineCode",{parentName:"p"},"ctx.state.args")," object"),(0,r.kt)("h3",{id:"error-handling"},"Error handling"),(0,r.kt)("p",null,"When arguments validation fails, and ",(0,r.kt)("inlineCode",{parentName:"p"},"errorHandler")," not declared in ",(0,r.kt)("inlineCode",{parentName:"p"},"options"),", plugin throws original ",(0,r.kt)("inlineCode",{parentName:"p"},"joi")," error,\nwhich you can handle with ",(0,r.kt)("inlineCode",{parentName:"p"},"bot.catch")," handler. But this is not very convenient,"),(0,r.kt)("p",null,"So you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"errorHandler")," to register a handler to be called on an error with an error object and\nthe current context, you can use the context object to e.g. to tell user about an error"),(0,r.kt)("h3",{id:"result-object"},"Result object"),(0,r.kt)("p",null,"You can get plugin result in ",(0,r.kt)("inlineCode",{parentName:"p"},"ctx.state.args"),", that object contains properties, showed in table:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Example"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"raw")),(0,r.kt)("td",{parentName:"tr",align:null},"Raw arguments array"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"['username', '100']"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"args")),(0,r.kt)("td",{parentName:"tr",align:null},"Result remapped object, contains validated / remapped arguments"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{ username: 'username', balance 100 } "))))),(0,r.kt)("h2",{id:"usage-example"},"Usage example"),(0,r.kt)("h3",{id:"command"},"Command"),(0,r.kt)(l.Z,{defaultValue:"joi",values:[{label:"Validation & mapping",value:"joi"},{label:"Parsing & mapping",value:"parse-mapping"},{label:"Only parsing",value:"parse"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"joi",mdxType:"TabItem"},(0,r.kt)(u.Z,{sx:{mb:"1rem"},target:"_blank",href:"/docs/live-examples/plugin-arguments#validation--mapping",color:"success",variant:"outlined",mdxType:"Button"},"TRY NOW"),(0,r.kt)(o.Z,{url:g+"/commands/validation-mapping.js",showLineNumbers:!0,mdxType:"GithubBlock"})),(0,r.kt)(i.Z,{value:"parse-mapping",mdxType:"TabItem"},(0,r.kt)(u.Z,{sx:{mb:"1rem"},target:"_blank",href:"/docs/live-examples/plugin-arguments#parsing--mapping",color:"success",variant:"outlined",mdxType:"Button"},"TRY NOW"),(0,r.kt)(o.Z,{url:g+"/commands/parsing-mapping.js",showLineNumbers:!0,mdxType:"GithubBlock"})),(0,r.kt)(i.Z,{value:"parse",mdxType:"TabItem"},(0,r.kt)(u.Z,{sx:{mb:"1rem"},target:"_blank",href:"/docs/live-examples/plugin-arguments#only-parsing",color:"success",variant:"outlined",mdxType:"Button"},"TRY NOW"),(0,r.kt)(o.Z,{url:g+"/commands/only-parsing.js",showLineNumbers:!0,mdxType:"GithubBlock"}))),(0,r.kt)("h3",{id:"inline-query"},"Inline query"),(0,r.kt)(l.Z,{defaultValue:"joi",values:[{label:"Validation & mapping",value:"joi"},{label:"Parsing & mapping",value:"parse-mapping"},{label:"Only parsing",value:"parse"}],mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"joi",mdxType:"TabItem"},(0,r.kt)(o.Z,{url:g+"/inline-query/validation-mapping.js",showLineNumbers:!0,mdxType:"GithubBlock"})),(0,r.kt)(i.Z,{value:"parse-mapping",mdxType:"TabItem"},(0,r.kt)(o.Z,{url:g+"/inline-query/parsing-mapping.js",showLineNumbers:!0,mdxType:"GithubBlock"})),(0,r.kt)(i.Z,{value:"parse",mdxType:"TabItem"},(0,r.kt)(o.Z,{url:g+"/inline-query/only-parsing.js",showLineNumbers:!0,mdxType:"GithubBlock"}))),(0,r.kt)("h1",{id:"flowchart"},"Flowchart"),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Click to expand"),(0,r.kt)("center",null,(0,r.kt)(s.Z,{chart:'\n flowchart TB\n  U("Incoming update") --\x3e M("Upstream middlewares")\n  M --\x3e F("Filter by given update types")\n  F --\x3e E("Has command entity?")\n  E -- No --\x3e N("Nothing to do, run next")\n  E -- Yes --\x3e Parsing --\x3e HV("Need mapping?")\n  HV -- No --\x3e K\n  HV -- Yes --\x3e Mapping --\x3e NV("Need validation?")\n  NV -- No --\x3e K\n  NV -- Yes --\x3e VC("Validate / cast") --\x3e ISV("Valid?")\n  ISV -- Yes --\x3e K\n  ISV -- No --\x3e ER("Error handler")\n  K("Add result to <code>ctx.state</code> and run next") --\x3e DM("Downstream middlewares")\n',mdxType:"Mermaid"}))),(0,r.kt)("h2",{id:"additional-information"},"Additional Information"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Source:")," ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/OpengramJS/arguments"},"https://github.com/OpengramJS/arguments")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"NPM:")," ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@opengram/arguments"},"https://www.npmjs.com/package/@opengram/arguments")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Replit:")," ",(0,r.kt)("a",{parentName:"li",href:"https://replit.com/team/Opengram"},"https://replit.com/team/Opengram"))))}N.isMDXComponent=!0},1748:(e,t,a)=>{var n={"./locale":9234,"./locale.js":9234};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=l,e.exports=r,r.id=1748}}]);